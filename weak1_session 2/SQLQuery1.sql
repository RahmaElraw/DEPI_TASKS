
use DEPI_D1
CREATE TABLE DEPARTMENT(
DNUM INT PRIMARY KEY,
DNAME VARCHAR(20) NOT NULL,
LOCATION VARCHAR(50) NOT NULL,
HIRING_DATE DATE,
SSN INT 
)


CREATE TABLE EMPLOYEE(
SSN INT PRIMARY KEY,
BIRTHDATE DATE,
GENDER VARCHAR(10) NOT NULL,
FNAME VARCHAR(20) NOT NULL,
LNAME VARCHAR(20) NOT NULL,
SUPERVISOR INT,
DNUM INT,
FOREIGN KEY (SUPERVISOR) REFERENCES EMPLOYEE (SSN),
FOREIGN KEY (DNUM) REFERENCES DEPARTMENT (DNUM)
)


ALTER TABLE DEPARTMENT 
ADD CONSTRAINT FK_SSN
FOREIGN KEY (SSN) REFERENCES EMPLOYEE(SSN);



CREATE TABLE PROJECT(
PNUM INT PRIMARY KEY,
PNAME VARCHAR(20) NOT NULL,
LOCATION VARCHAR(20) NOT NULL,
DNUM INT,
FOREIGN KEY (DNUM) REFERENCES DEPARTMENT (DNUM) 
)

CREATE TABLE DEPENDENT(
NAME VARCHAR(20) NOT NULL,
GENDER VARCHAR(10) NOT NULL,
BIRTHDATE DATE,
SSN INT,
PRIMARY KEY(SSN,NAME),
FOREIGN KEY (SSN) REFERENCES EMPLOYEE (SSN)
)

create table Emp_Project(
SSN int,
PNum int,
WorkingHours varchar(50) not null,
primary key (ssn,pnum),
foreign key (ssn) references EMPLOYEE (SSN) on delete no action on update no action,
foreign key (pnum) references project (pnum) on delete no action on update no action
)


INSERT INTO DEPARTMENT(DNUM,DNAME,LOCATION)
VALUES
(1,'RESEARCH','NEW YORK'),
(2,'ADMENSTRATION','EGYPT'),
(3,'DEVELOPMENT','CANADA');



INSERT INTO EMPLOYEE (SSN,BIRTHDATE,GENDER,FNAME,LNAME,DNUM,SUPERVISOR)
VALUES
('123076','1965-01-09','MALE','AHMED','HANI','1','123456'),
('123456','1955-12-08','FEMALE','MONA','MOHAB','1','123456'),
('764338','1968-11-19','MALE','ALI','SAID','3','123456'),
('578432','1988-06-02','FEMALE','HODA','AKRAM','2','123456'),
('754390','1993-08-20','MALE','PELAL','KAREEM','3','123456');


INSERT INTO DEPENDENT(NAME,GENDER,BIRTHDATE,SSN)
VALUES
('ALI','MALE','1996-12-03','123456'),
('RAHMA','FEMALE','2000-05-19','754390'),
('HANI','MALE','1978-12-22','123076');


INSERT INTO PROJECT (PNUM, PNAME, LOCATION, DNUM)
VALUES
(1001, 'AI SYSTEM', 'NEW YORK', 1),
(1002, 'HR SYSTEM', 'EGYPT', 2),
(1003, 'APP DEV', 'CANADA', 3);
 

INSERT INTO Emp_Project (SSN, PNum, WorkingHours)
VALUES
(123076, 1001, '30'),
(754390, 1001, '20'),
(578432, 1002, '40'),
(123456, 1003, '35'),
(764338, 1003, '25');



UPDATE EMPLOYEE SET SUPERVISOR ='578432' WHERE SSN='123076';
UPDATE EMPLOYEE SET SUPERVISOR ='578432' WHERE SSN='123456';
UPDATE EMPLOYEE SET SUPERVISOR ='578432' WHERE SSN='754390';


UPDATE DEPARTMENT SET SSN='578432',HIRING_DATE='2020-05-22' WHERE DNUM=1; 
UPDATE DEPARTMENT SET SSN='123456',HIRING_DATE='2022-07-03' WHERE DNUM=2; 
UPDATE DEPARTMENT SET SSN='754390',HIRING_DATE='2019-01-01' WHERE DNUM=3; 


DELETE FROM DEPENDENT 
WHERE SSN='754390' AND NAME='RAHMA';


SELECT *
FROM EMPLOYEE
WHERE DNUM=1;


select * from Emp_Project ;
